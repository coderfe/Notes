# YaHoo军规---前端性能优化

**时间黄金法则:**只有10%-20%的时间花在下载HTML文档上,其余80%-90%都花在下载页面组件上

1. 减少HTTP请求（打开网页的时候，我们看到的文字，图片，多媒体每个内容都是从服务器获取的，每一个内容的获取，就是一个HTTP请求）
  - 图片`css sprite`
  - 图片地图,在一张图片上关联多个URL,URL最终指向取决于用户点击的位置
  - `script`合并、`css`合并
  - 内联图片,通过使用`data:URL`模式可以使页面包含图片但无需额外的HTTP请求

2. 使用`CDN`内容分发网络（`Content Delivery Network`其目的在于让用户可就近取得所需内容，解决网络拥挤的状况，提高用户的访问速度）

3. 压缩`javascript`和`css`(gzip)
  - 去除空格、空白符、注释符
  - 简写方法名、参数名,精简`javascript`脚本
  - `css`重用类,删除空的声明
  
4. `css`放在顶部`head`中(css at the top)
  - 避免页面出现空白或闪烁
  
5. `script`放在页面底部(script at the bottom)
  - 先呈现出内容，避免浏览器因脚本出错而停止加载内容
  
6. 避免在`css`中使用表达式，影响浏览器的性能

7. 将`javascript`和`css`放在外部文件
  - 单独提取
    * 提高复用性
    * 减小页面体积
    * 提高`js`和`css`的可维护性
    * 可单独缓存
  - 写在页面内（样式只应用于一个页面，不被经常访问，脚本和样式很少<20）
    * 减少页面请求
    * 提升页面渲染速度
    
8. 减少DNS查询（DNS查找可以缓存起来以提升性能）
  - IE 30m
  - Chrome 60s
  - Firefox 60s
  - 缓存时间长：减少DNS重复查找，节省时间
  - 缓存时间短：及时检测网站服务器的变化，保证访问的正确性
  
9. 避免重定向（用户的请求被重新转向其他请求）
  - 301：用户请求的页面被移动到其他位置，永久重定向，对搜索引擎更智能
  - 302：用户请求的的页面被找到了，但不在原始地址，临时重定向
  - 增加了服务器的往返次数
  
10. 移除重复脚本
  - 重复脚本会增加不必要的HTTP请求和执行javascript所浪费的时间

11. 配置实体标签（`Enity Tag`,Web服务器和浏览器用于确认缓存组件有效的一种机制)

12. 使用`AJAX`缓存(`Asynchronous Jacascript and XML`异步的`javascript`和`XML`)
  - 分批加载，局部更新
  - post：每次都执行（不被缓存）
  - get：同一地址不重复执行（可以缓存）

  ![get and post](imgs/getpost.png "get and post")
  
13. 添加`Expires`头(Web服务器可以通过Expires头来告诉Web客户端可以使用一个组件的当前副本,直到指定的日期为止)
14. YSlow分析工具
